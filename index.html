<!DOCTYPE html>
<html lang="en-us">
<head>
  <!-- ===== GitHub-optimized SEO (exact canonical + new OG image) ===== -->
  <meta charset="utf-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

  <title>GTA Mods – StaticQuasar931 (Unblocked GTA-style Modes)</title>
  <meta name="description" content="Play GTA Mods — GTA-style modes in your browser. Free, school-safe, Chromebook friendly. Works at school, work, or anywhere." />
  <meta name="robots" content="index, follow, max-image-preview:large" />
  <meta name="keywords" content="GTA Mods, GTA mod, GTA game, GTA g@me, GTA unblocked, GTA at school, GTA working at school, school safe games, unbl0cked, static, static 931, staticquasar931, staticquasar 931, staticq, staticq931, gta browser, gta like game" />
  <link rel="canonical" href="https://staticquasar931.github.io/GTA-Mods/" />

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="GTA Mods – GTA-style Modes (Unblocked)" />
  <meta property="og:description" content="Play GTA-style modes free in your browser. School-safe, Chromebook friendly." />
  <meta property="og:url" content="https://staticquasar931.github.io/GTA-Mods/" />
  <meta property="og:image" content="https://res.cloudinary.com/dcsrqennd/image/upload/v1758327608/GTA_Mods_StaticQuasar931_vua0h4.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="theme-color" content="#0aa" />

  <!-- Schema.org -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"VideoGame",
    "name":"GTA Mods – GTA-style Modes",
    "url":"https://staticquasar931.github.io/GTA-Mods/",
    "author":{"@type":"Organization","name":"StaticQuasar931"},
    "publisher":{"@type":"Organization","name":"StaticQuasar931"},
    "operatingSystem":"Web",
    "applicationCategory":"Game",
    "gamePlatform":["Web Browser"],
    "inLanguage":"en",
    "description":"GTA-style modes playable in the browser. Unblocked and school-safe on Chromebook, PC, and mobile."
  }
  </script>

  <!-- Hidden SEO block (safe in body; no layout impact) -->
  <div style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden">
    <h1>Play GTA Mods — GTA-style Modes in Browser (Unblocked & School-Safe)</h1>
    <p>
      GTA Mods is a GTA-like collection you can play right in your browser with no downloads. This GitHub Pages build
      aims to be school-safe and Chromebook friendly, with fast loading and a fullscreen canvas. Progress saving is handled
      locally with <strong>localStorage</strong> through a simple bridge so your settings and progress can persist between
      visits when the underlying build calls the exposed save/load functions. Looking for more unblocked titles and
      alternates? See the main list at
      <a href="https://sites.google.com/view/staticquasar931/gm3z">StaticQuasar931 Games</a> or request new ones via the
      <a href="https://sites.google.com/view/staticquasar931/google-form">Google Form</a>. Keywords: gta mods unblocked,
      gta like game, working at school, static, staticquasar931, static 931, staticq931.
    </p>
  </div>

  <!-- Styles (original stylesheet kept) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/centerclassroom/mc55@main/style.css">
  <style>
    html, body {
      margin:0; padding:0; height:100%; overflow:hidden;
      -webkit-touch-callout:none; -webkit-user-select:none; user-select:none;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:#000;
    }
    canvas:focus { outline: none; }

    /* Full-viewport Unity canvas & loading cover */
    #unity-container { position:fixed; inset:0; }
    #unity-canvas { width:100vw; height:100vh; display:block; cursor: default; }
    #loading-cover { position:fixed; inset:0; background:#000 center/cover no-repeat; display:none; }
  </style>
</head>
<body class="light">
  <!-- Unity DOM -->
  <div id="unity-container" class="unity-desktop">
    <canvas id="unity-canvas" tabindex="-1"></canvas>
  </div>
  <div id="loading-cover" style="background: url('background.png') center center / cover; display: none;">
    <div id="unity-loading-bar">
      <div id="unity-progress-bar-empty">
        <div id="unity-progress-bar-full" style="width: 0%;"></div>
      </div>
      <div class="spinner" style="display: none;"></div>
    </div>
  </div>

  <noscript>
    <style> #unity-container, #loading-cover { display:none !important; } </style>
    <div style="padding:16px;font-family:system-ui">JavaScript is required to play.</div>
  </noscript>

  <script>
    /* =========================
       Local progress saving (bridge)
       ========================= */
    const LS_PREFIX = "sq931.gta-mods.";
    const saveLS = (k,v)=>{ try{ localStorage.setItem(LS_PREFIX+k, JSON.stringify(v)); }catch(e){} };
    const loadLS = (k,d=null)=>{ try{ const v=localStorage.getItem(LS_PREFIX+k); return v?JSON.parse(v):d; }catch(e){ return d; } };

    // Expose simple save/load APIs many Unity web templates already call.
    (function setupLocalSaveBridge(){
      const SAVE_KEY = "gameSave.v1";
      window.GameSave = {
        save(data){
          try{
            const payload = (typeof data === "string") ? data : JSON.stringify(data||{});
            localStorage.setItem(LS_PREFIX + SAVE_KEY, payload);
            return "ok";
          }catch(e){ return "err"; }
        },
        load(){
          try{
            return localStorage.getItem(LS_PREFIX + SAVE_KEY) || "noData";
          }catch(e){ return "noData"; }
        },
        clear(){ try{ localStorage.removeItem(LS_PREFIX + SAVE_KEY); }catch(e){} }
      };
      // Back-compat names commonly looked for by builds
      window.SaveCloud = function(data){ return window.GameSave.save(data); };
      window.LoadCloud = function(){ return window.GameSave.load(); };
      window.InitPlayer = function(){ return Promise.resolve("noAuth"); };
      window.GetPayments = function(){ return Promise.resolve("none"); };
      window.StickyAdActivity = function(){}; window.Review = function(){};
      window.PromptShow = function(){}; window.InitLeaderboards = function(){};
      window.GetLeaderboardScores = function(){}; window.SetLeaderboardScores = function(){};
      window.ConsumePurchase = function(){}; window.flasgsData = function(){};
    })();

    // Warn on close (requested standard)
    window.onbeforeunload = function(){
      return "Leave this page? Local progress is saved when possible.";
    };
  </script>

  <!-- ===== Unity loader / game boot (actual needed code) ===== -->
  <script>
    // Paths exactly as in your working build
    const buildUrl  = "https://cdn.jsdelivr.net/gh/centerclassroom/mc55@main/Build";
    const loaderUrl = buildUrl + "/bb0d9ecdb05db3e84da20bd14a4f84dc.loader.js";

    // Base config (single-file URLs). The loader will fetch frameworkUrl & others itself.
    const baseConfig = {
      dataUrl:       buildUrl + "/cffd2fddc93a5e3bb5ff56ac3bb5a297.data.br",
      frameworkUrl:  buildUrl + "/c39bf58f300a834e953a20c745c5e5f2.framework.js",
      codeUrl:       buildUrl + "/d649f30ffe591eef6765ee27d7fc980f.wasm.br",
      streamingAssetsUrl: "StreamingAssets",
      companyName:   "DefaultCompany",
      productName:   "GtaArcade",
      productVersion:"0.1"
    };

    const container        = document.getElementById("unity-container");
    const canvas           = document.getElementById("unity-canvas");
    const loadingCover     = document.getElementById("loading-cover");
    const progressBarEmpty = document.getElementById("unity-progress-bar-empty");
    const progressBarFull  = document.getElementById("unity-progress-bar-full");
    const spinner          = document.querySelector(".spinner");

    // Responsive canvas sizing (pixel-perfect)
    function resizeCanvas(){
      const dpr = Math.min(window.devicePixelRatio || 1, 2);
      canvas.width  = Math.floor(window.innerWidth  * dpr);
      canvas.height = Math.floor(window.innerHeight * dpr);
      canvas.style.width = "100vw";
      canvas.style.height = "100vh";
    }
    resizeCanvas(); addEventListener("resize", resizeCanvas);

    // Mobile class like original
    if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
      container.className = "unity-mobile";
    }

    // Show loading screen
    loadingCover.style.background = "url('background.png') center/cover";
    loadingCover.style.display = "";

    // Prevent context menu & keep focus on canvas
    addEventListener('contextmenu', e => e.preventDefault());
    function FocusGame(){ try{ window.focus(); canvas.focus(); }catch(e){} }
    addEventListener('pointerdown', FocusGame);
    addEventListener('touchstart',  FocusGame);

    // ===== Optional: support split-file (part0..partN) if they exist =====
    async function headOK(url){
      try{ const r = await fetch(url, {method:'HEAD'}); return r.ok; }catch(e){ return false; }
    }
    async function mergeFileParts(fileUrl, partCount) {
      const parts = [];
      for (let i = 0; i < partCount; i++) {
        const partUrl = `${fileUrl}.part${i}`;
        const resp = await fetch(partUrl);
        if (!resp.ok) throw new Error(`Missing ${partUrl}`);
        parts.push(await resp.arrayBuffer());
      }
      const total = parts.reduce((s,p)=>s+p.byteLength,0);
      const merged = new Uint8Array(total);
      let off = 0;
      for (const p of parts) { merged.set(new Uint8Array(p), off); off += p.byteLength; }
      return URL.createObjectURL(new Blob([merged], { type: 'application/octet-stream' }));
    }
    async function prepareConfig(cfg){
      // Prefer single files; if .part0 exists, merge 4 parts (adjust if your host slices differently)
      const dataBase = cfg.dataUrl;
      const wasmBase = cfg.codeUrl;
      const hasDataParts = await headOK(dataBase + ".part0");
      const hasWasmParts = await headOK(wasmBase + ".part0");
      try{ cfg.dataUrl = hasDataParts ? await mergeFileParts(dataBase, 4) : dataBase; }catch(e){ cfg.dataUrl = dataBase; }
      try{ cfg.codeUrl = hasWasmParts ? await mergeFileParts(wasmBase, 4) : wasmBase; }catch(e){ cfg.codeUrl = wasmBase; }
      return cfg;
    }

    // ===== Boot real Unity instance (this is the ACTUAL needed code) =====
    (function boot(){
      const s = document.createElement("script");
      s.src = loaderUrl;
      s.onload = async () => {
        try {
          const cfg = await prepareConfig({ ...baseConfig });
          createUnityInstance(canvas, cfg, (progress) => {
            spinner.style.display = "none";
            progressBarEmpty.style.display = "";
            progressBarFull.style.width = `${Math.floor(progress*100)}%`;
          }).then((unityInstance) => {
            // Ready
            loadingCover.style.display = "none";
            // If your Unity side expects saved data immediately, you could send it here:
            // const saved = window.GameSave.load();
            // if (saved && saved !== "noData") { unityInstance.SendMessage("BridgeObject","OnSaveLoaded", saved); }
          }).catch((err) => {
            console.error("Unity load error:", err);
          });
        } catch (e) {
          console.error("Boot error:", e);
        }
      };
      s.onerror = () => console.error("Failed to load Unity loader:", loaderUrl);
      document.body.appendChild(s);
    })();

    // Ignore noisy unhandled rejections from stubbed APIs
    addEventListener("unhandledrejection", (e)=>{ console.warn("Suppressed rejection:", e.reason); e.preventDefault(); });
  </script>
</body>
</html>
